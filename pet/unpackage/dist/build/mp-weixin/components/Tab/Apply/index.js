"use strict";var e=require("../../../common/vendor.js");if(!Array){(e.resolveComponent("unicloud-db")+e.resolveComponent("uni-load-more")+e.resolveComponent("uni-popup-dialog")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../../node-modules/@dcloudio/uni-components/lib/unicloud-db/unicloud-db.js")+(()=>"../../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js")+(()=>"../../../uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog.js")+(()=>"../../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();const o=e.defineComponent({__name:"index",props:{where:null},setup(o){const n=o,a=e.pn.getCurrentUserInfo().uid,{where:t}=e.toRefs(n),i=e.ref(!0);e.watch((()=>t.value),(e=>{t.value=e,t.value!=`state=='申请中'&&user_id=='${a}'`?i.value=!1:i.value=!0}));const l=e.pn.database(),p=e.ref(null);e.onPullDownRefresh((()=>{p.value.loadData((()=>{e.index.stopPullDownRefresh()}))})),e.onReachBottom((()=>{p.value.loadMore()}));const u=e.ref(null),d=e.ref();e.ref([]);const r=async()=>{await l.collection("apply").where(`_id=='${d.value}'`).update({state:"已取消"}).then((()=>{p.value.refresh(),e.index.showToast({title:"成功取消该申请",icon:"none"})}))};return(o,n)=>({a:e.w((({data:o,pagination:n,loading:a,error:t,options:l,hasMore:p},r,s)=>e.e({a:t},t?{b:e.t(t.message)}:e.e({c:e.f(o,((o,n,a)=>({a:e.w((({data:n,loading:a,error:t,options:l},p,r)=>e.e({a:t},t?{b:e.t(t.message)}:e.e({c:null==n?void 0:n.img[0].url,d:e.t(null==n?void 0:n.pet_name),e:e.t(null==n?void 0:n.variety),f:i.value},i.value?{g:e.o((o=>{return a=null==n?void 0:n._id,void e.index.navigateTo({url:`/pages/ApplyAdopt/Apply/index?adoptId=${a}`});var a}))}:{},{h:e.o((n=>{return a=o._id,void e.index.navigateTo({url:`/pages/Mine/Request/Apply/ApplyDetail/index?inApplyId=${a}`});var a})),i:i.value},i.value?{j:e.o((e=>{return n=o._id,d.value=n,void u.value.open("center");var n}))}:{}),{k:r,l:p})),{name:"d",path:"a["+s+"].c["+a+"].a",vueId:"10f24f70-1-"+s+"-"+a+",10f24f70-0"}),b:"10f24f70-1-"+s+"-"+a+",10f24f70-0",c:e.p({collection:"adoption",field:"_id,pet_name,img,variety,adopt_id",getone:!0,where:`_id=='${o.adopt_id}'`}),d:o._id}))),d:a},a?{e:"10f24f70-2-"+s+",10f24f70-0",f:e.p({status:"loading"})}:{},{g:p&&!a},p&&!a?{h:"10f24f70-3-"+s+",10f24f70-0",i:e.p({status:"more"})}:p||a?{}:{k:"10f24f70-4-"+s+",10f24f70-0",l:e.p({status:"noMore"})},{j:!p&&!a}),{m:s,n:r})),{name:"d",path:"a",vueId:"10f24f70-0"}),b:e.sr(p,"10f24f70-0",{k:"udb"}),c:e.p({collection:"apply","page-size":5,getone:!1,where:e.unref(t)}),d:e.o(r),e:e.p({type:"warn",cancelText:"关闭",confirmText:"确定取消",title:"通知",content:"你确定要取消领养该宠物吗"}),f:e.sr(u,"10f24f70-5",{k:"alertDialog"}),g:e.p({type:"dialog"})})}});var n=e._export_sfc(o,[["__scopeId","data-v-10f24f70"]]);wx.createComponent(n);
