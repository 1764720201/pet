"use strict";var e=require("../../../common/vendor.js");if(!Array){(e.resolveComponent("tui-icon")+e.resolveComponent("uni-dateformat")+e.resolveComponent("uni-load-more")+e.resolveComponent("unicloud-db"))()}Math||(a+(()=>"../../../node-modules/thorui-uni/lib/thorui/tui-icon/tui-icon.js")+(()=>"../../../uni_modules/uni-dateformat/components/uni-dateformat/uni-dateformat.js")+(()=>"../../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js")+(()=>"../../../node-modules/@dcloudio/uni-components/lib/unicloud-db/unicloud-db.js"))();const a=()=>"../../../components/pick-regions/pick-regions.js",t=e.defineComponent({__name:"index",setup(a){var t;const o=e.ref(""),n=e.ref(["全部","喵星人","汪星人","其它"]),r=e.ref(["全部","男生","女生"]),i=e.ref(["全部","近一周","近一个月","近三个月"]),u=Date.now(),d=e=>{"全部"!=n.value[e.detail.value]?o.value=`star=='${n.value[e.detail.value]}'`:o.value=""},l=e=>{"全部"!=r.value[e.detail.value]?o.value=`gender=='${r.value[e.detail.value]}'`:o.value=""},s=u-604800,c=u-2678400,m=u-8035200,v=e=>{switch(i.value[e.detail.value]){case"全部":o.value="";break;case"近一周":o.value=`create_time<=${s}`;break;case"近一个月":o.value=`create_time<=${c}&&create_time>${s}`;break;case"近三个月":o.value=`create_time<=${m}&&create_time>${c}`}},p=e.getCurrentInstance();null==(t=null==p?void 0:p.proxy)||t.$Bus.on("found-search",(e=>{o.value=`variety=='${e}'||star=='${e}'||type=='${e}'||city=='${e}'||gender=='${e}'`}));const b=e=>{o.value=`city=='${e[2].name}'`},f=e.pn.getCurrentUserInfo().uid,g=e.ref(null);return e.onPullDownRefresh((()=>{g.value.loadData((()=>{e.index.stopPullDownRefresh()}))})),e.onReachBottom((()=>{g.value.loadMore()})),(a,t)=>({a:e.o(d),b:n.value,c:e.o(l),d:r.value,e:e.o(b),f:e.o(v),g:i.value,h:e.w((({data:a,pagination:t,loading:o,error:n,hasMore:r},i,u)=>e.e({a:n},n?{b:e.t(n.message)}:{c:e.f(a,((a,t,o)=>e.e({a:a.uploadPicture[0].path,b:a.reward},a.reward?{c:e.t("酬金"+a.reward+"元")}:{},{d:e.t(a.type),e:e.t(a.title),f:e.t(a.variety),g:e.t(a.gender),h:"37a940b0-2-"+u+"-"+o+",37a940b0-1",i:e.t(a.city[1]),j:e.t(a.city[2]),k:"37a940b0-3-"+u+"-"+o+",37a940b0-1",l:e.p({date:a.create_time,format:"yyyy-MM-dd hh:mm:ss"}),m:a._id,n:e.o((t=>{return o=a._id,void e.index.navigateTo({url:`/pages/Home/Enlightenment/index?id=${o}`,success(){e.pn.callFunction({name:"footprint",data:{userId:f,foundId:o}})}});var o}),a._id)}))),d:e.p({name:"position",size:24})},{e:o},o?{f:"37a940b0-4-"+u+",37a940b0-1",g:e.p({status:"loading"})}:{},{h:r&&!o},r&&!o?{i:"37a940b0-5-"+u+",37a940b0-1",j:e.p({status:"more"})}:r||o?{}:{l:"37a940b0-6-"+u+",37a940b0-1",m:e.p({status:"noMore"})},{k:!r&&!o,n:u,o:i})),{name:"d",path:"h",vueId:"37a940b0-1"}),i:e.sr(g,"37a940b0-1",{k:"udb"}),j:e.p({collection:"foundPet",orderby:"create_time desc",field:"reward,create_time,city,title,gender,uploadPicture,_id,type,variety",getone:!1,where:o.value,"page-size":4})})}});var o=e._export_sfc(t,[["__scopeId","data-v-37a940b0"]]);wx.createComponent(o);
