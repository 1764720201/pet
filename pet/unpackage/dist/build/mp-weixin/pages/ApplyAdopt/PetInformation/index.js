"use strict";var e=require("../../../common/vendor.js");if(!Array){(e.resolveComponent("Collect")+e.resolveComponent("uni-icons")+e.resolveComponent("tui-icon")+e.resolveComponent("uni-dateformat")+e.resolveComponent("uni-popup-dialog")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../../node-modules/thorui-uni/lib/thorui/tui-icon/tui-icon.js")+(()=>"../../../uni_modules/uni-dateformat/components/uni-dateformat/uni-dateformat.js")+n+(()=>"../../../uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog.js")+(()=>"../../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();const n=()=>"../Poster/index.js",o=e.defineComponent({__name:"index",props:{petInfo:null},setup(n){var o;const t=n,u=e.getCurrentInstance(),i=e.reactive({uid:""}),l=e.ref(null),a=e.ref(),r=()=>{l.value.open("center")};null==(o=null==u?void 0:u.proxy)||o.$Bus.on("ifCollect2",(e=>{a.value=e}));const{petInfo:p}=e.toRefs(t);e.watch((()=>p.value._id),(e=>{p.value._id=e,s.collection("collect").where(`user_id=='${i.uid}'&&adopt_id=='${p.value._id}'`).get().then((e=>{var n;(null==(n=e.result.data[0])?void 0:n._id)?a.value=!0:a.value=!1}))})),e.onShow((()=>{Object.assign(i,e.pn.getCurrentUserInfo())})),e.onLoad((()=>{Object.assign(i,e.pn.getCurrentUserInfo())}));const s=e.pn.database(),d=()=>{var n;i.uid?(null==(n=null==u?void 0:u.proxy)||n.$Bus.emit("ifCollect",!a.value),a.value?s.collection("collect").where(`user_id=='${i.uid}'&&adopt_id=='${p.value._id}'`).remove().then((()=>{a.value=!1,e.index.showToast({title:"取消收藏",icon:"none"})})):e.pn.callFunction({name:"collect",data:{userId:i.uid,adoptId:p.value._id,type:0}}).then((()=>{a.value=!0,e.index.showToast({title:"收藏成功",icon:"none"})}))):e.index.navigateTo({url:"/uni_modules/uni-id-pages/pages/login/login-withoutpwd?type=weixin"})};return(n,o)=>({a:e.t(e.unref(p).pet_name),b:e.t("男生"==e.unref(p).gender?"♂":"♀"),c:e.p({type:"star",size:"30",color:a.value?"#d78797":"#ccc"}),d:e.o(d),e:e.t(e.unref(p).pet_name),f:e.t(e.unref(p).age),g:e.t(e.unref(p).variety),h:e.t(e.unref(p).gender),i:e.t(e.unref(p).city[1]),j:e.t(e.unref(p).city[2]),k:e.t(e.unref(p).punch?e.unref(p).punch:"未设置"),l:e.o(r),m:e.p({name:"about-fill",size:15,color:"#d78797"}),n:e.t(e.unref(p).story),o:e.f(e.unref(p).request,((n,o,t)=>({a:e.t(n),b:n}))),p:e.p({name:"clock",size:15}),q:e.p({date:e.unref(p).issue_time,format:"yyyy-MM-dd hh:mm:ss"}),r:e.p({petInfo:e.unref(p)}),s:e.p({type:"info",cancelText:"取消",confirmText:"确认",title:"领养打卡须知",content:"平台流程领养成功后,即可打卡,每周至少一次,反馈宠物动态"}),t:e.sr(l,"5ed5707a-6",{k:"alertDialog"}),v:e.p({type:"dialog"})})}});var t=e._export_sfc(o,[["__scopeId","data-v-5ed5707a"]]);wx.createComponent(t);
