"use strict";var e=require("../../../common/vendor.js");if(!Array){(e.resolveComponent("uni-file-picker")+e.resolveComponent("uni-forms-item")+e.resolveComponent("uni-data-checkbox")+e.resolveComponent("uni-data-picker")+e.resolveComponent("uni-data-select")+e.resolveComponent("uni-forms"))()}Math||((()=>"../../../uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker.js")+(()=>"../../../uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.js")+(()=>"../../../uni_modules/uni-data-checkbox/components/uni-data-checkbox/uni-data-checkbox.js")+(()=>"../../../uni_modules/uni-data-picker/components/uni-data-picker/uni-data-picker.js")+(()=>"../../../uni_modules/uni-data-select/components/uni-data-select/uni-data-select.js")+(()=>"../../../uni_modules/uni-forms/components/uni-forms/uni-forms.js"))();const a=e.defineComponent({__name:"index",setup(a){const t=e.reactive({uid:0}),l=e.pn.database();e.onShow((()=>{Object.assign(t,e.pn.getCurrentUserInfo())})),e.onLoad((()=>{Object.assign(t,e.pn.getCurrentUserInfo()),t.uid?l.collection("uni-id-users").where(`_id=='${t.uid}'`).field("nickname").get().then((e=>{o.name=e.result.data[0].nickname,console.log(o.name)})):e.index.navigateTo({url:"/uni_modules/uni-id-pages/pages/login/login-withoutpwd?type=weixin"})}));const r=e.ref(null),u=e.reactive({petName:{rules:[{required:!0,errorMessage:"宠物名不能为空"},{maxLength:5,errorMessage:"宠物名最多5个字"}]},name:{rules:[{required:!0,errorMessage:"姓名不能为空"}]},wxCode:{rules:[{required:!0,errorMessage:"微信号不能为空"}]},request:{rules:[{required:!0,errorMessage:"领养要求不能为空"}]},source:{rules:[{required:!0,errorMessage:"来源不能为空"}]},medical:{rules:[{required:!0,errorMessage:"医疗不能为空"}]},uploadPicture:{rules:[{required:!0,errorMessage:"图片不能为空"}]},stroy:{rules:[{required:!0,errorMessage:"领养要求不能为空"},{maxLength:200,errorMessage:"字数最多200"}]},variety:{rules:[{required:!0,errorMessage:"品种不能为空"}]},age:{rules:[{required:!0,errorMessage:"年龄不能为空"}]},city:{rules:[{required:!0,errorMessage:"城市不能为空"}]},phone:{rules:[{required:!0,errorMessage:"手机号不能为空"},{format:"number",errorMessage:"手机号必须为数字"}]}}),o=e.reactive({story:"",name:"",variety:"",phone:"",city:[],petName:"",genderIndex:0,punchIndex:0,age:"",wxCode:"",uploadPicture:[],medical:[],source:[],request:[],particular:[],starIndex:1,video:[]}),i=e.reactive([{text:"汪星人",value:0},{text:"喵星人",value:1},{text:"其他",value:2}]),n=e.reactive([{text:"男生",value:0},{text:"女生",value:1}]),s=e.reactive([{text:"已绝育",value:0},{text:"已免疫",value:1},{text:"已驱虫",value:2}]),d=e.reactive([{text:"家养",value:0},{text:"个人求助",value:1},{text:"流浪基地",value:2}]),c=e.reactive([{text:"不满1个月",value:0},{text:"1个月",value:1},{text:"2个月",value:2},{text:"3-6个月",value:3},{text:"6个月-1岁",value:4},{text:"1岁",value:5},{text:"2岁",value:6},{text:"3岁及以上",value:7}]),p=e.reactive([{text:"高冷",value:0},{text:"粘人",value:1},{text:"铁憨憨",value:2},{text:"甜美",value:3},{text:"温文尔雅",value:4},{text:"乖巧",value:5},{text:"贪玩",value:6},{text:"胆小",value:7},{text:"叛逆",value:8},{text:"懒惰",value:9},{text:"无攻击性",value:10},{text:"不挑食",value:11},{text:"不乱叫",value:12},{text:"讲卫生",value:13}]),m=e.reactive([{text:"仅限同城",value:0},{text:"接受回访",value:1},{text:"签订协议",value:2},{text:"绝育",value:3},{text:"安装纱窗",value:4},{text:"办理狗证",value:5},{text:"出门牵绳",value:6}]),v=e.reactive([{text:"不需要打卡",value:0},{text:"4周",value:1},{text:"5周",value:2},{text:"8周",value:3},{text:"12周",value:4},{text:"16周",value:5}]),x=e=>{o.city.push(e.detail.value[0].text),o.city.push(e.detail.value[1].text),o.city.push(e.detail.value[2].text)},g=e=>{o.age=e.detail.value[0].text},h=()=>{const a=o.medical.map((e=>s[e].text)),l=o.source.map((e=>d[e].text)),u=o.particular.map((e=>p[e].text)),c=o.request.map((e=>m[e].text));r.value.validate().then((()=>{e.pn.callFunction({name:"adoption",data:{user_id:t.uid,imageList:o.uploadPicture,petName:o.petName,star:i[o.starIndex].text,variety:o.variety,gender:n[o.genderIndex].text,age:o.age,medicalList:a,source:l,particularList:u,story:o.story,requestList:c,punch:v[o.punchIndex].text,name:o.name,city:o.city,phone:o.phone,wx_code:o.wxCode,video:o.video,ifAdopt:!1},success(){e.index.showToast({title:"发布成功"})},fail(e){console.log(e)}})})).then((()=>{e.index.navigateBack()})).catch((e=>{console.log(e)}))};return(a,t)=>({a:e.o((e=>o.uploadPicture=e)),b:e.p({limit:"3","file-mediatype":"image",modelValue:o.uploadPicture}),c:e.p({name:"uploadPicture"}),d:e.o((e=>o.video=e)),e:e.p({limit:"1","file-mediatype":"video",modelValue:o.video}),f:o.petName,g:e.o((e=>o.petName=e.detail.value)),h:e.p({label:"宠物昵称",name:"petName"}),i:e.o((e=>o.starIndex=e)),j:e.p({mode:"tag",localdata:i,modelValue:o.starIndex}),k:e.p({label:"星球",name:"star"}),l:o.variety,m:e.o((e=>o.variety=e.detail.value)),n:e.p({label:"品种",name:"variety"}),o:e.o((e=>o.genderIndex=e)),p:e.p({mode:"tag",localdata:n,modelValue:o.genderIndex}),q:e.p({label:"性别",name:"gender"}),r:e.o(g),s:e.o((e=>o.age=e)),t:e.p({localdata:c,"popup-title":"请选择年龄",modelValue:o.age}),v:e.p({label:"年龄",name:"age"}),w:e.o((e=>o.medical=e)),x:e.p({mode:"tag",multiple:!0,localdata:s,modelValue:o.medical}),y:e.p({label:"医疗",name:"medical"}),z:e.o((e=>o.source=e)),A:e.p({mode:"tag",multiple:!0,localdata:d,modelValue:o.source}),B:e.p({label:"宠物来源",name:"source"}),C:e.o((e=>o.particular=e)),D:e.p({mode:"tag",multiple:!0,localdata:p,max:"3",modelValue:o.particular}),E:e.p({name:"particular"}),F:o.story,G:e.o((e=>o.story=e.detail.value)),H:e.p({name:"story"}),I:e.o((e=>o.request=e)),J:e.p({mode:"tag",multiple:!0,localdata:m,modelValue:o.request}),K:e.p({name:"request"}),L:e.o((e=>o.punchIndex=e)),M:e.p({localdata:v,clear:!1,modelValue:o.punchIndex}),N:e.p({label:"送养成功后,要求领养人打卡",name:"punch"}),O:o.name,P:e.o((e=>o.name=e.detail.value)),Q:e.p({label:"姓名",name:"name"}),R:e.o(x),S:e.p({placeholder:"请选择地址","popup-title":"请选择城市",collection:"opendb-city-china",field:"code as value, name as text",orderby:"value asc","step-searh":!0,"self-field":"code","parent-field":"parent_code"}),T:e.p({label:"所在城市",name:"city"}),U:o.phone,V:e.o((e=>o.phone=e.detail.value)),W:e.p({label:"手机号",name:"phone"}),X:o.wxCode,Y:e.o((e=>o.wxCode=e.detail.value)),Z:e.p({label:"微信号",name:"wxCode"}),aa:e.sr(r,"8a1ec24e-0",{k:"form"}),ab:e.p({rules:u,"label-width":"150",modelValue:o}),ac:e.o(h)})}});var t=e._export_sfc(a,[["__scopeId","data-v-8a1ec24e"]]);wx.createPage(t);
