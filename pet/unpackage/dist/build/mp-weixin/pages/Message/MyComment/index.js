"use strict";var e=require("../../../common/vendor.js");if(!Array){(e.resolveComponent("uni-dateformat")+e.resolveComponent("uni-load-more")+e.resolveComponent("unicloud-db"))()}Math||((()=>"../../../uni_modules/uni-dateformat/components/uni-dateformat/uni-dateformat.js")+(()=>"../../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js")+(()=>"../../../node-modules/@dcloudio/uni-components/lib/unicloud-db/unicloud-db.js"))();const d=e.defineComponent({__name:"index",setup(d){const o=e.pn.database(),n=e.pn.getCurrentUserInfo().uid,i=e.ref(null);e.onPullDownRefresh((()=>{i.value.loadData((()=>{e.index.stopPullDownRefresh()}))})),e.onReachBottom((()=>{i.value.loadMore()}));const t=e.reactive([o.collection("comment").field("found_id,adopt_id,comment,nickname,avatar_url,create_time,user_id").orderBy("create_time","desc").getTemp(),o.collection("adoption").where(`user_id=='${n}'`).field("_id,img").getTemp({getOne:!0}),o.collection("foundPet").where(`user_id=='${n}'`).field("_id,uploadPicture").getTemp({getOne:!0})]);return(d,o)=>({a:e.w((({data:d,pagination:o,loading:n,error:i,hasMore:t},a,r)=>e.e({a:i},i?{b:e.t(i.message)}:{c:e.f(d,((d,o,n)=>e.e({a:d.adopt_id[0]||d.found_id[0]},d.adopt_id[0]||d.found_id[0]?e.e({b:null==d?void 0:d.avatar_url,c:e.o((o=>{return n=null==d?void 0:d.user_id,void e.index.navigateTo({url:`/pages/ApplyAdopt/UserInfo/index?userId=${n}`});var n})),d:e.t(null==d?void 0:d.nickname),e:"77fd65e2-1-"+r+"-"+n+",77fd65e2-0",f:e.p({date:null==d?void 0:d.create_time,format:"yyyy-MM-dd hh:mm:ss"}),g:d.adopt_id[0]},d.adopt_id[0]?{h:d.adopt_id[0].img[0].url,i:e.o((o=>{return n=d.adopt_id[0]._id,void e.index.navigateTo({url:`/pages/ApplyAdopt/index?id=${n}`});var n}))}:{},{j:d.found_id[0]},d.found_id[0]?{k:d.found_id[0].uploadPicture[0].url,l:e.o((o=>{return n=d.found_id[0]._id,void e.index.navigateTo({url:`/pages/Home/Enlightenment/index?id=${n}`});var n}))}:{},{m:e.t(null==d?void 0:d.comment)}):{},{n:d._id})))},{d:n},n?{e:"77fd65e2-2-"+r+",77fd65e2-0",f:e.p({status:"loading"})}:{},{g:t&&!n},t&&!n?{h:"77fd65e2-3-"+r+",77fd65e2-0",i:e.p({status:"more"})}:t||n?{}:{k:"77fd65e2-4-"+r+",77fd65e2-0",l:e.p({status:"noMore"})},{j:!t&&!n,m:r,n:a})),{name:"d",path:"a",vueId:"77fd65e2-0"}),b:e.sr(i,"77fd65e2-0",{k:"udb"}),c:e.p({collection:t,getone:!1,"page-size":10})})}});var o=e._export_sfc(d,[["__scopeId","data-v-77fd65e2"]]);wx.createPage(o);
