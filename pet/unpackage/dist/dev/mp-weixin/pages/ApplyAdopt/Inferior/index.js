"use strict";var e=require("../../../common/vendor.js");Array||e.resolveComponent("uni-icons")();const v=()=>"../../../uni_modules/uni-icons/components/uni-icons/uni-icons.js";Math||v();const g=e.defineComponent({__name:"index",props:{petInfo:{type:Object,required:!0}},setup(a){var c;const d=a,u=e.getCurrentInstance(),n=e.ref(!1);(c=u==null?void 0:u.proxy)==null||c.$Bus.on("ifCollect",i=>{n.value=i});const r=()=>{e.index.pageScrollTo({scrollTop:1300,duration:300})},t=e.reactive({uid:""}),{petInfo:o}=e.toRefs(d);e.watch(()=>o.value._id,()=>{l.collection("collect").where(`user_id=='${t.uid}'&&adopt_id=='${o.value._id}'`).get().then(i=>{var s;(s=i.result.data[0])!=null&&s._id?n.value=!0:n.value=!1})});const p=()=>{o.value.user_id==t.uid?e.index.showToast({title:"\u4E0D\u80FD\u54A8\u8BE2\u81EA\u5DF1"}):e.index.navigateTo({url:`/pages/Chat/index?id=${o.value.user_id}`})};e.onShow(()=>{Object.assign(t,e.pn.getCurrentUserInfo())}),e.onLoad(()=>{Object.assign(t,e.pn.getCurrentUserInfo())});const l=e.pn.database(),_=()=>{var i;t.uid?((i=u==null?void 0:u.proxy)==null||i.$Bus.emit("ifCollect2",!n.value),n.value?l.collection("collect").where(`user_id=='${t.uid}'&&adopt_id=='${o.value._id}'`).remove().then(()=>{n.value=!1,e.index.showToast({title:"\u53D6\u6D88\u6536\u85CF",icon:"none"})}):e.pn.callFunction({name:"collect",data:{userId:t.uid,adoptId:o.value._id,type:0}}).then(()=>{n.value=!0,e.index.showToast({title:"\u6536\u85CF\u6210\u529F",icon:"none"})})):e.index.navigateTo({url:"/uni_modules/uni-id-pages/pages/login/login-withoutpwd?type=weixin"})},f=()=>{o.value.if_adopt?e.index.showToast({title:"\u5DF2\u88AB\u9886\u517B"}):o.value.user_id==t.uid?e.index.showToast({title:"\u4F60\u4E0D\u80FD\u9886\u517B\u81EA\u5DF1\u7684\u5BA0\u7269",icon:"none"}):e.index.navigateTo({url:`./Apply/index?adoptId=${o.value._id}`})};return(i,s)=>({a:e.p({type:"chatboxes",size:25}),b:e.o(r),c:e.o(p),d:e.o(f),e:e.p({type:"star",size:25,color:n.value?"#d78797":"#ccc"}),f:e.o(_)})}});var x=e._export_sfc(g,[["__file","C:/Users/yzc/Desktop/pet/pages/ApplyAdopt/Inferior/index.vue"]]);wx.createComponent(x);
