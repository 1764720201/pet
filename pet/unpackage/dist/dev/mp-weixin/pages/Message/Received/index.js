"use strict";var e=require("../../../common/vendor.js");const x=e.defineComponent({__name:"index",props:{hasLogin:{type:Boolean,required:!0},userId:{type:String,required:!0}},setup(m){const _=m,{hasLogin:g,userId:n}=e.toRefs(_),o=e.pn.database(),u=async()=>{const c=o.collection("comment").where(`comment_type==0||comment_user_id=='${n.value}'`).getTemp(),a=o.collection("collect").where("type==0||type==1||type==4").field("adopt_id,topic_id,found_id,_id,type").getTemp();d(c,"comment"),await d(a,"collect")};e.watch(()=>g.value,async()=>{await u()}),e.onShow(async()=>{await u()});const s=e.ref(0),i=e.ref(0),v=()=>{e.index.navigateTo({url:"./MyComment/index"})},f=()=>{e.index.navigateTo({url:"./MyCollect/index"})},d=async(c,a)=>{i.value=0,s.value=0;const r=a,y=o.collection("adoption").where(`user_id=='${n.value}'`).getTemp(),h=o.collection("foundPet").where(`user_id=='${n.value}'`).getTemp(),w=o.collection("topic").where(`user_id=='${n.value}'`).getTemp();await o.collection(c,y,h,w).field("size(adopt_id) as adopt,size(topic_id) as topic,size(found_id) as found").groupBy("num").groupField("sum(adopt) as sumAdopt,sum(found) as sumFound,sum(topic) as sumTopic").get({getOne:!0}).then(l=>{const p=Object.values(l.result.data);if(r=="collect")for(let t=1;t<4;t++)i.value+=p[t];else if(r=="comment")for(let t=1;t<4;t++)s.value+=p[t]}).catch(l=>{console.log(l)})};return(c,a)=>({a:e.t(i.value),b:e.o(f),c:e.t(s.value),d:e.o(v)})}});var C=e._export_sfc(x,[["__scopeId","data-v-5cad1fb6"],["__file","C:/Users/yzc/Desktop/pet/pages/Message/Received/index.vue"]]);wx.createComponent(C);
