"use strict";var e=require("../../../common/vendor.js");if(!Array){const D=e.resolveComponent("uni-icons"),b=e.resolveComponent("uni-dateformat"),t=e.resolveComponent("unicloud-db"),i=e.resolveComponent("uni-load-more"),h=e.resolveComponent("uni-popup-dialog"),g=e.resolveComponent("uni-popup");(D+b+t+i+h+g)()}const U=()=>"../../../uni_modules/uni-icons/components/uni-icons/uni-icons.js",S=()=>"../../../uni_modules/uni-dateformat/components/uni-dateformat/uni-dateformat.js",G=()=>"../../../node-modules/@dcloudio/uni-components/lib/unicloud-db/unicloud-db.js",H=()=>"../../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js",J=()=>"../../../uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog.js",K=()=>"../../../uni_modules/uni-popup/components/uni-popup/uni-popup.js";Math||(U+S+G+H+J+K)();const L=e.defineComponent({__name:"index",props:{state:{type:String,required:!0}},setup(D){const b=D,{state:t}=e.toRefs(b),i=e.ref(null),h=e.pn.getCurrentUserInfo().uid,g=s=>{e.index.navigateTo({url:`/pages/Mine/Request/Receive/ProposerDetail/index?applyId=${s}`})},a=e.pn.database();let v=e.reactive([]);const w=e.ref(null),B=e.ref(null),E=e.ref(null),c=e.ref(),m=e.ref(),T=()=>{a.collection("apply").where(`_id=='${c.value}'`).update({state:"\u9001\u517B\u6210\u529F"}).then(()=>{a.collection("adoption").where(`_id=='${m.value}'`).update({if_adopt:!0})}).then(()=>{i.value.refresh(),e.index.showToast({title:"\u5DF2\u6210\u529F\u9001\u517B"})})},$=()=>{a.collection("apply").where(`_id=='${c.value}'`).update({state:"\u5DF2\u62D2\u7EDD"}).then(()=>{i.value.refresh(),e.index.showToast({title:"\u5DF2\u6210\u529F\u62D2\u7EDD"})})},k=()=>{a.collection("apply").where(`_id=='${c.value}'`).update({state:"\u5DF2\u53D6\u6D88"}).then(()=>{i.value.refresh(),e.index.showToast({title:"\u5DF2\u6210\u529F\u53D6\u6D88"})})},j=(s,l)=>{c.value=s,m.value=l,w.value.open("center")},A=(s,l)=>{c.value=s,m.value=l,B.value.open("center")},I=(s,l)=>{c.value=s,m.value=l,E.value.open("center")};e.watch(()=>t.value,()=>{v=[a.collection("adoption").where(`user_id=='${h}'`).field("_id,img,pet_name,issue_time").getTemp(),a.collection("apply").where(`state=='${t.value}'`).getTemp()]},{immediate:!0});const R=s=>{e.index.navigateTo({url:`/pages/Chat/index?id=${s}`})};return(s,l)=>({a:e.w(({data:q,pagination:O,loading:r,error:F,hasMore:f},z,d)=>e.e({a:F},F?{b:e.t(F.message)}:e.e({c:e.f(q,(o,Q,_)=>{var x,y,C;return e.e({a:(x=o==null?void 0:o._id)==null?void 0:x.apply},(y=o==null?void 0:o._id)!=null&&y.apply?{b:e.f((C=o==null?void 0:o._id)==null?void 0:C.apply,(u,V,p)=>e.e(e.unref(t)=="\u7533\u8BF7\u4E2D"?{a:e.o(n=>I(u._id,u.adopt_id)),b:"70db907e-1-"+d+"-"+_+"-"+p+",70db907e-0",c:e.p({type:"trash",size:"25",color:"#777"})}:{},{d:"70db907e-2-"+d+"-"+_+"-"+p+",70db907e-0",e:e.w(({data:n},M,P)=>({a:n==null?void 0:n.avatar_file.url,b:e.t(n==null?void 0:n.nickname),c:P,d:M}),{name:"d",path:"a["+d+"]."+("c["+_+"]."+("b["+p+"]."))+"e",vueId:"70db907e-3-"+d+"-"+_+"-"+p+",70db907e-0"}),f:e.t(u==null?void 0:u.city[0]),g:e.t(u==null?void 0:u.city[1]),h:e.t(u==null?void 0:u.city[2]),i:e.t(u.sincerity),j:"70db907e-3-"+d+"-"+_+"-"+p+",70db907e-0",k:e.p({collection:"uni-id-users",getone:!0,field:"avatar_file,nickname",where:`_id=='${u.user_id}'`}),l:"70db907e-4-"+d+"-"+_+"-"+p+",70db907e-0",m:e.o(n=>R(u.user_id)),n:e.o(n=>g(u._id))},e.unref(t)=="\u7533\u8BF7\u4E2D"?{o:e.o(n=>j(u._id,u.adopt_id))}:{},e.unref(t)=="\u7533\u8BF7\u4E2D"?{p:e.o(n=>A(u._id,u.adopt_id))}:{},{q:u._id})),c:o.img[0].url,d:e.t(o.pet_name),e:e.unref(t)=="\u7533\u8BF7\u4E2D",f:e.p({date:o.issue_time,format:"yyyy-MM-dd hh:mm:ss"}),g:e.p({type:"chat",size:"30",color:"white"}),h:e.unref(t)=="\u7533\u8BF7\u4E2D",i:e.unref(t)=="\u7533\u8BF7\u4E2D"}:{},{j:o==null?void 0:o._id._value})}),d:r},r?{e:"70db907e-5-"+d+",70db907e-0",f:e.p({status:"loading"})}:{},{g:f&&!r},f&&!r?{h:"70db907e-6-"+d+",70db907e-0",i:e.p({status:"more"})}:!f&&!r?{k:"70db907e-7-"+d+",70db907e-0",l:e.p({status:"noMore"})}:{},{j:!f&&!r}),{m:d,n:z}),{name:"d",path:"a",vueId:"70db907e-0"}),b:e.sr(i,"70db907e-0",{k:"udb"}),c:e.p({collection:e.unref(v),orderby:"issue_time desc",getone:!1,["page-size"]:25}),d:e.o(T),e:e.p({type:"warning",cancelText:"\u53D6\u6D88",confirmText:"\u540C\u610F",title:"\u540C\u610F",content:"\u4F60\u786E\u5B9A\u8981\u5C06\u8BE5\u5BA0\u7269\u9001\u7ED9\u7533\u8BF7\u4EBA\u5417"}),f:e.sr(w,"70db907e-8",{k:"allow"}),g:e.p({type:"dialog"}),h:e.o($),i:e.p({type:"warning",cancelText:"\u5173\u95ED",confirmText:"\u62D2\u7EDD",title:"\u62D2\u7EDD",content:"\u4F60\u786E\u5B9A\u8981\u62D2\u7EDD\u8BE5\u7533\u8BF7\u5417"}),j:e.sr(B,"70db907e-10",{k:"refuse"}),k:e.p({type:"dialog"}),l:e.o(k),m:e.p({type:"warning",cancelText:"\u5173\u95ED",confirmText:"\u53D6\u6D88\u7533\u8BF7",title:"\u53D6\u6D88\u7533\u8BF7",content:"\u4F60\u786E\u5B9A\u8981\u53D6\u6D88\u8BE5\u7533\u8BF7\u5417"}),n:e.sr(E,"70db907e-12",{k:"cancel"}),o:e.p({type:"dialog"})})}});var N=e._export_sfc(L,[["__scopeId","data-v-70db907e"],["__file","C:/Users/yzc/Desktop/pet/components/Tab/Receive/index.vue"]]);wx.createComponent(N);
