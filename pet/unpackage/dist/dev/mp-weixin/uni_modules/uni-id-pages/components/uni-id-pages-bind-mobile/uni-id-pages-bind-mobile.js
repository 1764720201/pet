"use strict";var e=require("../../../../common/vendor.js");const t=e.pn.database();t.collection("uni-id-users");const u=e.pn.importObject("uni-id-co"),l={emits:["success"],computed:{},data(){return{}},methods:{async beforeGetphonenumber(){return await new Promise((o,n)=>{e.index.showLoading({mask:!0}),wx.checkSession({success(){console.log("session_key \u672A\u8FC7\u671F"),o(),e.index.hideLoading()},fail(){console.log("session_key \u5DF2\u7ECF\u5931\u6548\uFF0C\u6B63\u5728\u6267\u884C\u66F4\u65B0"),wx.login({success({code:s}){e.pn.importObject("uni-id-co",{customUI:!0}).loginByWeixin({code:s}).then(i=>{console.log(i),o()}).catch(i=>{console.log(i),n()}).finally(i=>{console.log(i),e.index.hideLoading()})},fail:s=>{console.error(s),n()}})}})})},async bindMobileByMpWeixin(o){console.log(o),o.detail.errMsg=="getPhoneNumber:ok"?(console.log(o.detail),await this.beforeGetphonenumber(),u.bindMobileByMpWeixin(o.detail).then(n=>{console.log(n),this.$emit("success")}).finally(n=>{this.closeMe()})):this.closeMe()},async open(){this.$refs.popup.open()},closeMe(o){this.$refs.popup.close()}}};Array||e.resolveComponent("uni-popup")();const a=()=>"../../../uni-popup/components/uni-popup/uni-popup.js";Math||a();function r(o,n,s,i,m,c){return{a:e.o((...p)=>c.closeMe&&c.closeMe(...p)),b:e.o((...p)=>c.bindMobileByMpWeixin&&c.bindMobileByMpWeixin(...p)),c:e.sr("popup","612c1e01-0"),d:e.p({type:"bottom"})}}var d=e._export_sfc(l,[["render",r],["__scopeId","data-v-612c1e01"],["__file","C:/Users/yzc/Desktop/pet/uni_modules/uni-id-pages/components/uni-id-pages-bind-mobile/uni-id-pages-bind-mobile.vue"]]);wx.createComponent(d);
